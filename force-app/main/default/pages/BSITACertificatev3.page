<apex:page renderAs="PDF" standardController="Enrollment__c" showHeader="false" pageStyle="all" >
<head>
<!-- ReviewPDFcertNewV1   

25/03/2015 - JS - Updated code to match Global PRD and updated reference to bespoke record type which looked to Global PRD
19/09/2017 - JS - Updated code to incorporate latest APAC changes, SSIP, Probitas and Internal courses
05/02/2018 - JS - Updated code to Include update for VN, IN and MY - Project 0069
13/03/2018 - JS - Updated the code to show different date format for KR yyyy/MM/dd same as JP  (Should review date formats at somepoint in time when move to components?)
15/03/2018 - JS - Commented out signature for VN
06/04/2018 - JS - Changed size of DE signature, added issue date for modular courses and shows original course dates for non IRCA exam resit
09/04/2018 - JS - Adjusted CN and TW names to come from correct fields
19/11/2018 - JS - Fixed dates for JP split dates
-->

<style type="text/css" media="print">
body{font-family: Arial Unicode MS; font-size: 10pt;}
@page{
    @bottom-left { 
    content: element(footer);      
    }  
    size: A4 landscape;
    margin-top:.0cm;
    margin-left:0cm;
    margin-right:0cm;
    margin-bottom:0cm;         
}
.footer {
   position: fixed;
   left: 12mm;
   bottom: 6mm;
   z-index:+2;
   font-size: 7pt;
   line-height: 4px;
   }
.small8 {
    font-size: 7pt;
    text-align: left;
    line-height: 4px;
   }
.size8 {
    font-size: 8pt;
    text-align: left;
    }
.size12 {
    font-size: 12pt;
    text-align: left;
    }
.size15 {
    font-size: 15pt;
    text-align: left;
    }    
.size22 {
    font-weight: bold;
    font-size: 22pt;
    text-align: left;
    line-height: 34px;
    }
.size28 {
    font-weight: bold;  
    font-size: 28pt;
    text-align: left;
    line-height: 28px;
    }     
.size33 {
    font-weight: bold;  
    font-size: 33pt;
    text-align: left;
    line-height: 34px;
    
    }   
</style>
</head> 

<!---- this sets the background template image for the certificate---->

<img src="{!URLFOR($Resource.TrainingCertificatesv4, 'BSI_training_certificate_newv4-2014.jpg')}" style="position: fixed; left: 0cm; top:0cm; z-index:-2" width="29.7cm" height="21cm"/> 
<body>

<!---- this creates a table to insert the text in the correct places---->
  <table   width="99%" table-layout="fixed">

    <!---- this inserts a space at the top---->
    <tr>
        <td width ="0.8cm" ></td>
        <td height="120"></td>
    </tr>
    
<!--BSI TRAINING ACADEMY-->    
    
    <tr>
        <td width ="0.8cm" ></td>
        <td align="left" valign="bottom" height="40">
        <!---- this brings in the text "BSI Training Academy" for all countries in size 33.  For JP is is size 28 and for KR the translation is displayed for "Local" and as BSI Training Academy for "English"---->
            <apex:outputText styleClass="size33" rendered="{!NOT(OR(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',AND(Enrollment__c.Translation_Formula__c = 'Korea (Korean)',Enrollment__c.Certificate_Language__c = "English")))}" value="{!Enrollment__c.Training_Translations__r.BSI_Training_Academy__c}"/>
            <apex:outputText styleClass="size28"  rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',true,false)}" value="{!Enrollment__c.Training_Translations__r.BSI_Training_Academy__c}"/>
            <apex:outputText styleClass="size33" rendered="{!IF((Enrollment__c.Translation_Formula__c = 'Korea (Korean)') && Enrollment__c.Certificate_Language__c = "English",true,false)}" value="BSI Training Academy"/>
        </td>
    </tr>

<!--THIS IS TO CERTIFY THAT or variations--> 
       
    <tr> 
        <td width ="0.8cm" ></td>
        <td align="left" valign="bottom" height="50">
        <!---- JAPAN ONLY - this adds the first line of Japanese text for courses---->
             <apex:panelGroup rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',true,false)}"> 
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'JRCA - Pass',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_1__c}<br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'JRCA - Fail',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_2__c}<br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'JATA - Pass',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_1__c}<br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'JATA - Fail',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_2__c} <br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_1__c}<br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_1__c}<br/>" escape="false"/>
                <apex:outputText styleClass="size22" rendered="{!IF(AND((OR(Enrollment__c.Exam_results__c = Null,CONTAINS(Enrollment__c.Exam_results__c,'Fail'),CONTAINS(Enrollment__c.Exam_results__c,'fail'))),(NOT (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA')),(NOT (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JATA'))),true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Cert_Header_2__c}<br/>" escape="false"/>
            </apex:panelGroup>
           
        <!---- OTHER COUNTRIES (EXCEPT TURKEY) KR is blank for Local Language ---->
            <apex:panelGroup rendered="{!IF((Enrollment__c.Translation_Formula__c = 'Japan (Japanese)'||Enrollment__c.Translation_Formula__c = 'Turkey (Türkçe)'), false,true)}">               
                <apex:outputText rendered="{!IF(Enrollment__c.Certificate_Language__c = "Local",true,false)}" escape="false" styleClass="size12" value="{!Enrollment__c.Training_Translations__r.Text_Box_1__c}"/>
                <apex:outputText rendered="{!IF(Enrollment__c.Certificate_Language__c = "English",true,false)}" styleClass="size12" value="This is to certify that"/>
            </apex:panelGroup>
        </td>
    </tr>
    <!---- this inserts a space ---->
    <tr>
        <td width ="0.8cm" ></td>
        <td height="12" ></td>
    </tr>  
    <tr>
        <td width="0.8cm" height="20" ></td>
        <td align="left" valign="middle">
        
<!--DELEGATES NAME-->       
        
     <!-- In Characters for CN,JP ,TW and KR and VN.  KR and JP currently use "local fields for characters" and for JP a character is added after the character name)--> 
            <!-- TW and CN 20180409 JS changed to the below so show local fields<apex:outputText escape="false" rendered="{!IF(OR(Enrollment__c.Translation_Formula__c = 'Taiwan (Chinese)', Enrollment__c.Translation_Formula__c = 'China (Chinese)'),true,false)}" value="{!Enrollment__c.Delegate_name__r.LastName}{!Enrollment__c.Delegate_name__r.FirstName}<br/>" styleClass="size22"/>-->
            <apex:outputText escape="false" rendered="{!IF(OR(Enrollment__c.Translation_Formula__c = 'Taiwan (Chinese)', Enrollment__c.Translation_Formula__c = 'China (Chinese)'),true,false)}" value="{!Enrollment__c.Delegate_name__r.LastNameLocal}{!Enrollment__c.Delegate_name__r.FirstNameLocal}<br/>" styleClass="size22"/>
            
            <!-- Hide local name  if certificate language is English for JP  -->
            <apex:outputText escape="false" rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',Enrollment__c.Certificate_Language__c = 'Local'),true,false)}" value="{!Enrollment__c.Delegate_name__r.LastNameLocal}  {!Enrollment__c.Delegate_name__r.FirstNameLocal} 殿<br/>" styleClass="size22"/> 
            <apex:outputText escape="false" rendered="{!AND(OR(Enrollment__c.Translation_Formula__c = 'Korea (Korean)',Enrollment__c.Translation_Formula__c = 'Vietnam (Vietnamese)'), OR(Enrollment__c.Certificate_Language__c = 'English',Enrollment__c.Certificate_Language__c = 'Both'))}" value="{!Enrollment__c.Delegate_name__r.FirstName} {!Enrollment__c.Delegate_name__r.LastName}<br/>" styleClass="size22"/>
            <apex:outputText escape="false" rendered="{!AND(OR(Enrollment__c.Translation_Formula__c = 'Korea (Korean)',Enrollment__c.Translation_Formula__c = 'Vietnam (Vietnamese)'), OR(Enrollment__c.Certificate_Language__c = 'Local',Enrollment__c.Certificate_Language__c = 'Both'))}" value="{!Enrollment__c.Delegate_name__r.LastNameLocal}{!Enrollment__c.Delegate_name__r.FirstNameLocal}" styleClass="size22"/> 
            
     <!--In English - for Germany it shows the salutation - when Herr or Frau Dr it just shows Dr. For Singapore if local available shows LN FN-->
            
            <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Germany (Deutsch)',NOT(OR(Enrollment__c.Delegate_name__r.Salutation = 'Herr Dr.' ,Enrollment__c.Delegate_name__r.Salutation = 'Frau Dr.'))),true,false)}" value="{!Enrollment__c.Delegate_name__r.Salutation} {!Enrollment__c.Delegate_name__r.Name}" styleClass="size22"/>
            <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Germany (Deutsch)',OR(Enrollment__c.Delegate_name__r.Salutation = 'Herr Dr.' ,Enrollment__c.Delegate_name__r.Salutation = 'Frau Dr.')),true,false)}" value="Dr. {!Enrollment__c.Delegate_name__r.Name}" styleClass="size22"/>
            <apex:outputText rendered="{!IF(NOT(OR(Enrollment__c.Translation_Formula__c = 'Korea (Korean)',Enrollment__c.Translation_Formula__c = 'Vietnam (Vietnamese)',Enrollment__c.Translation_Formula__c = 'China (Chinese)',Enrollment__c.Translation_Formula__c = 'Taiwan (Chinese)', Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', Enrollment__c.Translation_Formula__c = 'Germany (Deutsch)',Enrollment__c.Translation_Formula__c = 'Singapore (English)',Enrollment__c.Translation_Formula__c = 'Malaysia (English)')),true,false)}" value="{!Enrollment__c.Delegate_name__r.Name}" styleClass="size22"/>
            <apex:outputText rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',true,false)}" value="{!Enrollment__c.Delegate_name__r.FirstName} {!Enrollment__c.Delegate_name__r.LastName}" styleClass="size22"/>
            <!-- TW and CN 20180409 JS changed to the below so show normal instead of local fields
            <apex:outputText rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Taiwan (Chinese)',true,false)}" value="{!Enrollment__c.Delegate_name__r.FirstNameLocal}  {!Enrollment__c.Delegate_name__r.LastNameLocal}" styleClass="size22"/>
            <apex:outputText rendered="{!IF(Enrollment__c.Translation_Formula__c = 'China (Chinese)',true,false)}" value="{!Enrollment__c.Delegate_name__r.FirstNameLocal}  {!Enrollment__c.Delegate_name__r.LastNameLocal}" styleClass="size22"/>
            -->
            <apex:outputText rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Taiwan (Chinese)',true,false)}" value="{!Enrollment__c.Delegate_name__r.FirstName}  {!Enrollment__c.Delegate_name__r.LastName}" styleClass="size22"/>
            <apex:outputText rendered="{!IF(Enrollment__c.Translation_Formula__c = 'China (Chinese)',true,false)}" value="{!Enrollment__c.Delegate_name__r.FirstName}  {!Enrollment__c.Delegate_name__r.LastName}" styleClass="size22"/>
            <!-- Singapore and Malaysia (20180205) local fields populated -->
            <apex:outputText rendered="{!IF(OR(Enrollment__c.Translation_Formula__c = 'Singapore (English)',Enrollment__c.Translation_Formula__c = 'Malaysia (English)') && (NOT(ISBLANK(Enrollment__c.Delegate_name__r.FirstNameLocal))) && (NOT(ISBLANK(Enrollment__c.Delegate_name__r.LastNameLocal))),true,false)}" value="{!Enrollment__c.Delegate_name__r.LastNameLocal}  {!Enrollment__c.Delegate_name__r.FirstNameLocal}" styleClass="size22"/>
            <!-- Singapore  and Malaysia (20180205) local fields ARE ISBLANK -->
            <apex:outputText rendered="{!IF(OR(Enrollment__c.Translation_Formula__c = 'Singapore (English)',Enrollment__c.Translation_Formula__c = 'Malaysia (English)') && ((ISBLANK(Enrollment__c.Delegate_name__r.FirstNameLocal)) || (ISBLANK(Enrollment__c.Delegate_name__r.LastNameLocal))),true,false)}" value="{!Enrollment__c.Delegate_name__r.Name}" styleClass="size22"/>
       </td>
    </tr>

<!-- HAS ATTENDED/HAS ATTENDED AND PASSED-->   
    <tr> 
      <td width ="0.8cm" ></td>
      <td height="60" align="left" valign="middle">
      
      <!--JP courses-->
        <apex:panelGroup rendered="{!Enrollment__c.Translation_Formula__c = 'Japan (Japanese)'}">
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'JRCA - Pass',true,false)}" value="{!Enrollment__c.Training_Translations__r.JRCA_Pass_text__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'JRCA - Fail',true,false)}" value="{!Enrollment__c.Training_Translations__r.JRCA_Fail_Text__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'JATA - Pass',true,false)}" value="{!Enrollment__c.Training_Translations__r.JATA_Pass_text__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'JATA - Fail',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Pass__c}" escape="false"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & fail CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & pass CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & fail CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Pass__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & fail CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & pass CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & fail CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Pass__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF (Enrollment__c.Exam_results__c = Null,true,false)}" value="{!Enrollment__c.Training_Translations__r.JP_Attended_and_Fail__c}" escape="false"/>
        </apex:panelGroup>
         
       <!--  OTHER countries except TR-->
        <apex:panelGroup rendered="{!NOT(OR(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',Enrollment__c.Translation_Formula__c = 'Turkey (Türkçe)'))}">
             
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = null,true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = null,true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended and passed"/>
            
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Fail exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended and passed"/>
                        
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Fail exam & fail CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English",false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended and passed"/>
            
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'IOSH - Pass',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'IOSH - Pass',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended and passed"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'IOSH - Fail',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Exam_results__c = 'IOSH - Fail',true,false)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="has attended"/>
            <apex:panelGroup rendered="{!IF((Enrollment__c.Translation_Formula__c = 'India (English)' && Enrollment__c.Exam_results__c = 'Six Sigma - Pass'),true,false)}">
                <apex:outputText styleClass="size12" rendered="{!IF((CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"Green") || CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"Black" )),true,false)}" escape="false" value="{!Enrollment__c.Training_Translations__r.IN_Six_Sigma_Pass__c}"/>    
                <apex:outputText styleClass="size12" rendered="{!IF((CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"YELLOW" )),true,false)}" escape="false" value="{!Enrollment__c.Training_Translations__r.IN_Yellow_Six_Sigma__c}"/>    
                <apex:outputText styleClass="size12" rendered="{!IF(NOT(OR(CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"Green"),CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"Black"), CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"YELLOW"))),true,false)}" escape="false" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>    
            </apex:panelGroup>
            <apex:panelGroup rendered="{!IF((Enrollment__c.Translation_Formula__c = 'India (English)' && Enrollment__c.Exam_results__c = 'Six Sigma - Fail'),true,false)}">
                <apex:outputText styleClass="size12" rendered="{!IF((CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"YELLOW" )),true,false)}" escape="false" value="{!Enrollment__c.Training_Translations__r.IN_Yellow_Six_Sigma__c}"/>    
                <apex:outputText styleClass="size12" rendered="{!IF((CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"YELLOW" )),false,true)}" escape="false" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>    
            </apex:panelGroup>
            <apex:panelGroup rendered="{!IF((Enrollment__c.Translation_Formula__c = 'India (English)'),false,true)}">
                <apex:outputText styleClass="size12" rendered="{!Enrollment__c.Exam_results__c = 'Six Sigma - Pass'}" value="{!Enrollment__c.Training_Translations__r.Text_box_3__c}"/>
                <apex:outputText styleClass="size12" rendered="{!Enrollment__c.Exam_results__c = 'Six Sigma - Fail'}" value="{!Enrollment__c.Training_Translations__r.Text_Box_2__c}"/>
            </apex:panelGroup>      
       </apex:panelGroup>
       <!--Add additional text for Internal Courses
        <apex:outputText styleClass="size12" rendered="{!IF(Enrollment__c.Training_Event__r.Course_Type_Formula__c='Internal',true,false)}" escape="false" value=" the following internal course"/>    
        -->
        </td>      
    </tr> 
</table>

<!-- COURSE NAME-->

  <table   width="100%" table-layout="fixed">
    <tr>
        <td width ="0.8cm" height="70" ></td>
        <td align="left" height="1cm" valign="top"> 
        
        <!---- Japan - course name in Japanese.  The Japanese is taken from the field on Product (Japanese course name). Except for bespoke courses which show only the Training Event field.---->   
            <apex:panelGroup rendered="{!Enrollment__c.Translation_Formula__c = 'Japan (Japanese)'}">
                <apex:outputtext styleClass="size22" escape="false" rendered="{!NOT(Enrollment__c.Training_Event__r.Course__r.Bespoke_Event__c) }" value="{!Enrollment__c.Training_Event__r.Course__r.Japanese_Course_Name_for_Certificates__c}<br/>" />
                <!--think this might need to be updated at some point as potentially doens t do as expected if there is a course name in EN - check with JP if they want a change.  This is current code though-->
                <apex:outputtext styleClass="size22" escape="false" rendered="{!(Enrollment__c.Training_Event__r.Course__r.Bespoke_Event__c) }" value="{!Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c}<br/>" />
            </apex:panelGroup>
            
        <!---- For Korea and Vietnam only (VN added 29012018):-->
         
         <apex:panelGroup rendered="{!OR(Enrollment__c.Translation_Formula__c = 'Korea (Korean)',Enrollment__c.Translation_Formula__c = 'Vietnam (Vietnamese)')}"> 
            <!--Certificate Language on ENR = English-->
                <apex:outputText styleClass="size22" escape="false" rendered="{!Enrollment__c.Certificate_Language__c ='English'}" value="{!BLANKVALUE(Enrollment__c.Training_Event__r.English_Course_Name_for_Certificatetxt__c,Enrollment__c.Training_Event__r.Course__r.Course_Name_English__c)}"/>
            <!--Certificate Language on ENR = Local-->
                <apex:outputText styleClass="size22" escape="false" rendered="{!OR(Enrollment__c.Certificate_Language__c ='Local',Enrollment__c.Certificate_Language__c=null)}" value="{!BLANKVALUE(Enrollment__c.Training_Event__r.Bespoke_Course_Name_for_Certificate__c,Enrollment__c.Training_Event__r.Course__r.Product_Name_Local__c)}" />
            <!--Certificate Language on ENR = both-->
                 <apex:outputpanel rendered="{!Enrollment__c.Certificate_Language__c = 'Both'}">
                            <apex:outputText styleClass="size22" escape="false" value="{!BLANKVALUE(Enrollment__c.Training_Event__r.English_Course_Name_for_Certificatetxt__c,Enrollment__c.Training_Event__r.Course__r.Course_Name_English__c)}"/>
                            <br/>
                            <apex:outputText styleClass="size22" escape="false" value="{!BLANKVALUE(Enrollment__c.Training_Event__r.Bespoke_Course_Name_for_Certificate__c,Enrollment__c.Training_Event__r.Course__r.Product_Name_Local__c)}" />
                 </apex:outputpanel>
         </apex:panelGroup>    
            
        
        <!--OTHER COUNTRIES (except JP & KR & TR & from 29012018 VN) ---->
        
            <apex:panelGroup rendered="{!NOT(OR(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',Enrollment__c.Translation_Formula__c = 'Korea (Korean)', Enrollment__c.Translation_Formula__c = 'Vietnam (Vietnamese)'))}">
                <!--Certificate Language on ENR = Local-->       
                <apex:outputpanel rendered="{!IF(OR(Enrollment__c.Certificate_Language__c = "Local",Enrollment__c.Certificate_Language__c=""), true,false)}">
                    <apex:outputText styleClass="size22" escape="false" value="{!Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c}" />
                </apex:outputpanel>
                
                <!--Certificate Language on ENR = English-->
                <apex:outputText rendered="{!IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" escape="false" value="{!Enrollment__c.Training_Event__r.English_Course_Name_for_CertificateF__c}" styleClass="size22"/>
            
                <!--Certificate Language on ENR = Both---->        
                <apex:outputpanel rendered="{!IF(Enrollment__c.Certificate_Language__c = "Both", true,false)}">
                    <apex:outputText rendered="{!IF(Enrollment__c.Training_Event__r.RecordType.Name = 'Global Training Event (Bespoke)',false,true)}" escape="false" value="{!Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c}" styleClass="size22"/>
                    <apex:outputText rendered="{!IF(Enrollment__c.Training_Event__r.RecordType.Name = 'Global Training Event (Bespoke)',true,false)}" escape="false" value="{!Enrollment__c.Training_Event__r.Bespoke_Course_Name_for_Certificate__c}" styleClass="size22"/>
                    <br/>
                    <apex:outputText escape="false" value="{!Enrollment__c.Training_Event__r.English_Course_Name_for_CertificateF__c}" styleClass="size22"/>
                </apex:outputpanel>
                              
                <!----Special option Course Name ---->    
                <apex:outputText rendered="{!IF(Enrollment__c.Certificate_Language__c = "Special", true,false)}" escape="false" value="{!Enrollment__c.Training_Event__r.Special_Course_Name_for_Certificate__c}" styleClass="size22"/>  
           </apex:panelGroup>

            <!-- adds in an extra line for JRCA approved courses -->
            
            <apex:outputpanel rendered="{!IF(AND(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JRCA',OR(Enrollment__c.Training_Event__r.Course__r.Training_Taxonomy_Code__c ='ISM10901JAJP',Enrollment__c.Training_Event__r.Course__r.Training_Taxonomy_Code__c ='ISM11101JAJP' )),true,false)}" >
               <apex:outputText styleClass="size22" escape="false" value="JRCA登録 継続的専門能力開発(CPD)コース<br/>(ISO/IEC 27001の新旧規格の差分の内容を含んだ研修） "/> 
            </apex:outputpanel>
        </td>
    </tr>


<!-- space before signature or agenda for RU-->
    
        <tr>
        
        <apex:panelGroup rendered="{!(Enrollment__c.Training_Event__r.Event_Country__c='RU')}" >         
           <td width ="0.8cm" ></td>
           <td align="left" valign="middle"> 
              <apex:outputField styleClass="small8" value="{!Enrollment__c.Training_Event__r.Course__r.Agenda_for_Certificate__c}"/>            
           </td>           
        </apex:panelGroup> 
        <apex:panelGroup rendered="{!NOT(Enrollment__c.Training_Event__r.Event_Country__c='RU')}" >   
        <td width ="0.8cm" height="15" ></td>
           <td align="left" valign="middle"> 
              <apex:outputField value="{!Enrollment__c.Training_Translations__r.X14_Cht_space__c}"/> 
           </td>           
        </apex:panelGroup>      
       </tr> 
 </table>

<!--SIGNATURE and line-->

          <table   width="99%" table-layout="fixed" >
            <tr>
                <td width ="0.8cm" ></td>
                <td frame="below" style="align:left; valign:bottom; border-bottom: 1px solid #000;" height="50">
                 
                <!--Others--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='India (English)'||Enrollment__c.Translation_Formula__c ='France (French)'||Enrollment__c.Translation_Formula__c ='Germany (Deutsch)'||Enrollment__c.Translation_Formula__c ='Germany (English)'||Enrollment__c.Translation_Formula__c ='Turkey (Türkçe)'||Enrollment__c.Translation_Formula__c ='Italy (Italiano)'||Enrollment__c.Translation_Formula__c ='Spain (Spanish)'||Enrollment__c.Translation_Formula__c ='Netherlands (Dutch)'||Enrollment__c.Translation_Formula__c ='Netherlands (English)'||Enrollment__c.Translation_Formula__c ='Singapore (English)'||Enrollment__c.Translation_Formula__c ='Malaysia (English)'||Enrollment__c.Translation_Formula__c ='Thailand (Thai)'||Enrollment__c.Translation_Formula__c ='Korea (Korean)'||Enrollment__c.Translation_Formula__c ='Indonesia (English)')|| Enrollment__c.Translation_Formula__c ='Germany (Deutsch)'||Enrollment__c.Translation_Formula__c ='MEA (English)' || Enrollment__c.Translation_Formula__c ='Russia (Русский)' || Enrollment__c.Translation_Formula__c ='Japan (Japanese)' || Enrollment__c.Translation_Formula__c ='UK (English)'|| Enrollment__c.Translation_Formula__c ='Hong Kong (English)'|| Enrollment__c.Translation_Formula__c ='Vietnam (Vietnamese)', false,true)}" height="1.3cm" url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--FR,NL,ES,IT--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='France (French)'||Enrollment__c.Translation_Formula__c ='Italy (Italiano)'||Enrollment__c.Translation_Formula__c ='Spain (Spanish)'||Enrollment__c.Translation_Formula__c ='Netherlands (Dutch)'||Enrollment__c.Translation_Formula__c ='Netherlands (English)'), true,false)}" height="2cm" width="5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--VN- dont want to display signature for now <apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Vietnam (Vietnamese)', true,false)}" height="1.3cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/> -->
                <!--MY--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='Malaysia (English)'), true,false)}" height="2cm" width="5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--HK--><apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Hong Kong (English)', true,false)}" height="2cm" width="3.5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>     
                <!--DE--><apex:image rendered="{!OR(Enrollment__c.Translation_Formula__c ='Germany (Deutsch)',Enrollment__c.Translation_Formula__c ='Germany (English)')}" height="2cm" width="5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--TR--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='Turkey (Türkçe)'), true,false)}" height="2cm" width="6.5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--TH--><apex:outputtext rendered="{!IF(Enrollment__c.Translation_Formula__c ='Thailand (Thai)', true,false)}">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</apex:outputtext>
                         <apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Thailand (Thai)', true,false)}" height="2.3cm" width="6.7cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--SG--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='Singapore (English)'||Enrollment__c.Translation_Formula__c ='Indonesia (English)'), true,false)}" height="2cm" width="5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--UK--><apex:image rendered="{!IF((Enrollment__c.Translation_Formula__c ='UK (English)'), true,false)}" height="2.5cm" width="9cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--KR--><apex:outputtext rendered="{!IF(Enrollment__c.Translation_Formula__c ='Korea (Korean)', true,false)}">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</apex:outputtext>
                         <apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Korea (Korean)', true,false)}" height="1cm" width="3.5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--RU-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Russia (Русский)', true,false)}" style="align:center" height="2.6cm" width="3.2cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--JP-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='Japan (Japanese)', true,false)}" style="align:center" height="2cm" width="5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--IN--><apex:image rendered="{!IF(Enrollment__c.Translation_Formula__c ='India (English)', true,false)}" style="align:left" height="2.5cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <!--MEA before and after 2015-04-01    <apex:image rendered="{!Enrollment__c.Translation_Formula__c ='MEA (English)'}" width="7cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>   -->
                <apex:image rendered="{!AND(Enrollment__c.Translation_Formula__c="MEA (English)",(IF(Enrollment__c.Training_Event__r.Start_date__c >= DATEVALUE("2015-04-01"),TRUE,FALSE)))}"  width="7cm"  url="{!Enrollment__c.Training_Translations__r.Signature__c}"/>
                <apex:image rendered="{!AND(Enrollment__c.Translation_Formula__c ='MEA (English)',(IF(Enrollment__c.Training_Event__r.Start_date__c < DATEVALUE("2015-04-01"),TRUE,FALSE)))}" width="7cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000001Hf5d&amp;oid=00D200000000Evl" />
                         
                </td>
                <td width ="15.0cm"></td>
            </tr>
        </table>


<!--TRAINING MANAGERS NAME FROM TRANSLATIONS---->     
      <table   width="99%" align="centre" table-layout="fixed" >
        <tr>
            <td height="30"  width="0.8cm" ></td>
            <td valign="top">
            
                 <apex:panelGroup rendered="{!IF(Enrollment__c.Translation_Formula__c = 'MEA (English)',false,true)}"> 
                     <apex:outputText styleClass="size12" value="{!Enrollment__c.Training_Translations__r.Training_Manager__c}"/>
                 </apex:panelGroup>
             
                 <apex:panelGroup rendered="{!IF(Enrollment__c.Translation_Formula__c = 'MEA (English)',true,false)}"> 
                     <apex:outputText styleClass="size12" rendered="{!AND(Enrollment__c.Translation_Formula__c="MEA (English)",(IF(Enrollment__c.Training_Event__r.Start_date__c >= DATEVALUE("2015-04-01"),TRUE,FALSE)))}"  value="{!Enrollment__c.Training_Translations__r.Training_Manager__c}"/>
                     <apex:outputText styleClass="size12" rendered="{!AND(Enrollment__c.Translation_Formula__c ='MEA (English)',(IF(Enrollment__c.Training_Event__r.Start_date__c < DATEVALUE("2015-04-01"),TRUE,FALSE)))}"  value="Shahm Barhom, General Manager Training and Professional Services"/>         
                 </apex:panelGroup>
                 
            </td>
        </tr>
    </table>

<br/>

 <table width="99%" align="left" table-layout="fixed" >
    <tr>
    <td width="0.8cm" ></td>
    <td>
      <table  >
        
        <tr>
        <!--row 1- DATE AND DURATION------ -->

            <!--<td width="0.8cm" ></td>-->
            <td width="4.5cm" align="left">
                <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA')),false,true)&&IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" styleClass="size10" value="{!Enrollment__c.Training_Translations__r.Date__c}:"/>  
                <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA')),false,true)&&IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" styleClass="size10" value="Date:"/>
            </td>
            <td align="left" width="12cm"> 
                
                <!-- for all countries except Japan 13032018 also KR -->        
                <apex:outputpanel styleClass="size10" rendered="{!NOT(OR(Enrollment__c.Training_Event__r.Event_Country__c = "JP",Enrollment__c.Training_Event__r.Event_Country__c="KR"))}">
              
                <!--shows issue date for UK six sigma pass   - replaced by below for modular courses    
                <apex:outputpanel rendered="{!IF(((Enrollment__c.Exam_results__c = 'Six Sigma - Pass')&&(Enrollment__c.Translation_Formula__c = 'UK (English)')&&(CONTAINS(Enrollment__c.Training_Event__r.Course_Name_for_Certificate__c,"Six Sigma"))),true,false)}"> 
                    <apex:outputText value="{!day(Today())}/{!month(Today())}/{!year(Today())}"/>
                </apex:outputpanel> ---->
                
                <!-- shows issue date for UK Modular courses - includes six sigma 06/04/2018-->
                <apex:outputText rendered="{!AND(Enrollment__c.Translation_Formula__c = 'UK (English)',Enrollment__c.Training_Event__r.Module_Event__c)}" value="{0,date,dd/MM/yyyy}"> 
                    <apex:param value="{!TODAY()}"/>
                </apex:outputText>
                
               
                <!---- For when not UK Modular course ----> 
                <apex:outputpanel rendered="{!NOT(AND(Enrollment__c.Translation_Formula__c = 'UK (English)',Enrollment__c.Training_Event__r.Module_Event__c))}">
                            
                    <!---- shows original course dates for an resit pass with normal dates ---->

                    <apex:outputText rendered="{!AND(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit'),OR(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA'),NOT(Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Split_Date_Event__c))}" value="{0,date,dd/MM/yyyy} -  {1,date,dd/MM/yyyy}">
                      <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c }"/>
                      <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c }"/>
                    </apex:outputText>
            
                    <!---- shows original course dates for a resit pass with split dates ----> 
              
                    <apex:outputpanel rendered="{!AND(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit'),OR(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA'),(Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Split_Date_Event__c))}">


                        <apex:outputtext rendered="{!IF(AND((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,dd/MM/yyyy} - {1,date,dd/MM/yyyy} & {2,date,dd/MM/yyyy} - {3,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c =0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,dd/MM/yyyy} - {1,date,dd/MM/yyyy} & {2,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c =0)),true,false)}" value="{0,date,dd/MM/yyyy} & {1,date,dd/MM/yyyy} - {2,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                    
                        <apex:outputtext rendered="{!IF((Enrollment__c.Training_Event__r.Course_Duration_Days__c=2),true,false)}" value="{0,date,dd/MM/yyyy} & {1,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
            
                    </apex:outputpanel>                           
                    
                    <!-- For a course which is not a resit pass with 1 day or less duration shows the start date only --> 
                      
                    <apex:outputText rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c <= 1,NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}"  value="{0,date,dd/MM/yyyy}">
                        <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                    </Apex:outputText>  
                    
                    <!----For a course which is not a resit pass with more than 1 day duration and normal dates shows the start and end dates ----> 
                           
                    <apex:outputText rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c >1, NOT(Enrollment__c.Training_Event__r.Split_Date_Event__c),NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}" value="{0,date,dd/MM/yyyy} - {1,date,dd/MM/yyyy}">
                        <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                        <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                    </apex:outputText>                
                   
                    <!----For a course which is not a resit pass with more than 1 day duration with split dates shows the start and end dates of all sections ----> 
                                                      
                    <apex:outputpanel rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c >1, Enrollment__c.Training_Event__r.Split_Date_Event__c,NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}">

                        <apex:outputtext rendered="{!IF(AND((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,dd/MM/yyyy} - {1,date,dd/MM/yyyy} & {2,date,dd/MM/yyyy} - {3,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c =0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,dd/MM/yyyy} - {1,date,dd/MM/yyyy} & {2,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c =0)),true,false)}" value="{0,date,dd/MM/yyyy} & {1,date,dd/MM/yyyy} - {2,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                    
                       <apex:outputtext rendered="{!IF(Enrollment__c.Training_Event__r.Course_Duration_Days__c=2,true,false)}" value="{0,date,dd/MM/yyyy} & {1,date,dd/MM/yyyy}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                    </apex:outputpanel>
                    
                  </apex:outputpanel>    
                
                </apex:outputpanel>
                
                <!-- for Japan different date format JS 13032018 also KR -->
                <apex:outputpanel styleClass="size10" rendered="{!OR(Enrollment__c.Training_Event__r.Event_Country__c = "JP",Enrollment__c.Training_Event__r.Event_Country__c="KR")}">
            
                    <!---- shows original course dates for an resit pass with normal dates ---->

                    <apex:outputText rendered="{!AND(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit'),OR(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA'),NOT(Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Split_Date_Event__c))}" value="{0,date,yyyy/MM/dd} -  {1,date,yyyy/MM/dd}"> 
                        <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c }"/>
                        <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c }"/>
                    </apex:outputText>
            
                    <!---- shows original course dates for a resit pass with split dates ----> 
              
                    <apex:outputpanel rendered="{!AND(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit'),OR(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Exam_results__c = 'NON - Pass exam & pass CA'),(Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Split_Date_Event__c))}">

                        <apex:outputtext rendered="{!IF(AND((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,yyyy/MM/dd} - {1,date,yyyy/MM/dd} & {2,date,yyyy/MM/dd} - {3,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c =0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,yyyy/MM/dd} - {1,date,yyyy/MM/dd} & {2,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c =0)),true,false)}" value="{0,date,yyyy/MM/dd} & {1,date,yyyy/MM/dd} - {2,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                    
                        <apex:outputtext rendered="{!IF((Enrollment__c.Training_Event__r.Course_Duration_Days__c=2),true,false)}" value="{0,date,yyyy/MM/dd} & {1,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Original_IRCA_Course_Enrollment__r.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
            
                    </apex:outputpanel>
                                          
                    <!-- For a course which is not a resit pass with 1 day or less duration shows the start date only --> 
                      
                    <apex:outputText rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c <= 1,NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}"  value="{0,date,yyyy/MM/dd}">
                        <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                    </Apex:outputText>
                        
                   <!-- For a course which is not a resit pass with more than 1 day duration and normal dates shows the start and end dates --> 
                           
                    <apex:outputText rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c >1, NOT(Enrollment__c.Training_Event__r.Split_Date_Event__c),NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}" value="{0,date,yyyy/MM/dd} - {1,date,yyyy/MM/dd}">
                        <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                        <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                    </apex:outputText> 
          
                    <!-- For a course which is not a resit pass with more than 1 day duration with split dates shows the start and end dates of all sections --> 
                                              
                    <apex:outputpanel rendered="{!AND(Enrollment__c.Training_Event__r.Course_Duration_Days__c >1, Enrollment__c.Training_Event__r.Split_Date_Event__c,NOT(OR(Enrollment__c.Booking_status__c='Booked - Resit',Enrollment__c.Booking_status__c='Booked - BSI Employee Resit')))}">

                        <apex:outputtext rendered="{!IF(AND((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,yyyy/MM/dd} - {1,date,yyyy/MM/dd} & {2,date,yyyy/MM/dd} - {3,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c =0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c >0)),true,false)}" value="{0,date,yyyy/MM/dd} - {1,date,yyyy/MM/dd} & {2,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date_of_Section_1__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                        </Apex:outputText>
                        
                        <apex:outputtext rendered="{!IF(AND(((Enrollment__c.Training_Event__r.Course_Duration_Days__c>2)),(Enrollment__c.Training_Event__r.End_Date3__c - Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c >0) , (Enrollment__c.Training_Event__r.End_Date_of_Section_1__c - Enrollment__c.Training_Event__r.Start_date__c =0)),true,false)}" value="{0,date,yyyy/MM/dd} & {1,date,yyyy/MM/dd} - {2,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_Date_of_Section_2__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>
                    
                       <apex:outputtext rendered="{!IF(Enrollment__c.Training_Event__r.Course_Duration_Days__c=2,true,false)}" value="{0,date,yyyy/MM/dd} & {1,date,yyyy/MM/dd}">
                            <apex:param value="{!Enrollment__c.Training_Event__r.Start_date__c}"/>
                            <apex:param value="{!Enrollment__c.Training_Event__r.End_Date3__c}"/>
                        </Apex:outputText>  

                    </apex:outputpanel>
                    
                </apex:outputpanel>
                </td>
        
                <!--  duration  -->
                <!-- JP – NOT IEMA,IRCA,JATA,JRCA  Duration and Hours first line-->
                <apex:panelgroup rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',NOT(OR(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JRCA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JATA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IEMA'))), true, false)}">
                   <td align="left" width="5.5cm" style="padding-right:6px"><apex:outputText value="研修時間:"/></td> 
                   <td align="left" width="16cm"  style="padding-left:6px"><apex:outputText value="{!Enrollment__c.Training_Event__r.Course_Duration_Hours__c} Hours"/></td>
                   <!--<td align="left" width="1.5cm"></td>--> 
                </apex:panelgroup>
        
                <!-- 20170602 EB Course Duration added to certificate on 1st row -->
                  <apex:panelgroup rendered="{!IF(AND(NOT(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)'),(NOT(ISBLANK(Enrollment__c.Training_Translations__r.Duration_For_Certificates__c)))),true,false)}">
                      <td align="right" width="5.5cm" style="padding-right:6px"><apex:outputText value="{!Enrollment__c.Training_Translations__r.Duration_For_Certificates__c}:"/></td> 
                      <td align="left" width="3cm"><apex:outputText value="{!Enrollment__c.Training_Event__r.Course_Duration_Hours__c}"/></td>
                      <td align="left" width="19cm"></td>
                </apex:panelgroup> 
        
                <!---- For India pull in the course location ---->  
                
                <apex:panelgroup rendered="{!Enrollment__c.Training_Event__r.Event_Country__c = 'IN'}">
        
                   <td align="right" width="5.5cm" style="padding-right:6px"><apex:outputText value="Location:"/></td> 
                   <td align="left" width="16cm" ><apex:outputText >&nbsp;{!Enrollment__c.Training_Event__r.Venue_City__c}</apex:outputText></td>
                   <!--<td align="left" width="1.5cm"></td>--> 
                </apex:panelgroup>
        
                 <!---- For JATA/JRCA courses in Japan - this pulls in Duration and for JRCA, the term of validity----> 
                   <apex:panelgroup rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)',(OR(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JRCA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='JATA'))), true, false)}">
                
                       <td height="20" align="left" width="5.5cm" style="padding-right:6px"><apex:outputText styleClass="size10" value="研修時間:"/></td> 
                       <td align="left" width="16cm" style="padding-left:6px"><apex:outputText styleClass="size10" value="{!Enrollment__c.Training_Event__r.Course_Duration_Hours__c} Hours"/></td>
                   </apex:panelgroup>
        
        </tr>
        
        <tr>
        
        <!--row 2 -CERTIFICATE NUMBER AND company name for JP--------------------------------------------------------------------------------------- -->
        
                <!-- This pulls in the Certificate Number (= Enrollment No.) for the delegate -->
                <td width="4.5cm" valign="top" align="left">                
                <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA')),false,true)&& IF(Enrollment__c.Certificate_Language__c = "English", false,true)}" value="{!Enrollment__c.Training_Translations__r.Certificate_Number__c}"/>
                <apex:outputText rendered="{!IF(AND(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', (Enrollment__c.Training_Event__r.Course__r.Certified_Course__c ='IRCA')),false,true)&& IF(Enrollment__c.Certificate_Language__c = "English", true,false)}" value="Certificate Number:"/>
                </td>
                <td width="12cm" valign="top" align="left"><apex:outputText styleClass="size10" value="{!Enrollment__c.Name}"/> </td>
        
               <!-- JP – company name -->
                 <apex:panelgroup rendered="{!IF(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)', true, false)}">   
                   <td width="5.5cm" align="left" style="padding-right:6px"><apex:outputText value="主催者:"/></td> 
                   <td width="16cm" align="left" height="0.8cm" style="padding-left:6px"><apex:outputText value="BSIグループジャパン株式会社"/></td>
                   <!--<td align="left" width="10cm"></td>-->
                </apex:panelgroup>
        
        </tr>
        
    </table> 
    </td>
    </tr>
      
<!---- For Probitas, validity statement---->
    <!---- 8/11/2017 JS added space so logo moves down for SSIP - the section for JP below seems to have brought it higher - may also need to check the JP JATA logic as doesn't make sense when doing Japan BUT IT WORKS AND CHANGING IT IN GLOBAL MOVES THE JATA LOGO?-->
    <apex:panelGroup rendered="{!Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'SSIP'}"> 
                <tr>
                    <td width ="0.8cm" ></td> 
                    <td height="35" align="left"></td>
                </tr>
    </apex:panelGroup>
    <apex:panelGroup rendered="{!AND(NOT(Enrollment__c.Translation_Formula__c = 'Japan (Japanese)'),(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'JATA'))}"> 
          <apex:panelGroup rendered="{!IF(AND(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'Probitas'),true,false)}">
            
                 <tr>
                        <td width ="0.7cm" ></td> 
                        <td height="10" align="left"></td>
                 </tr>
                 <tr>
                    <td width ="0.7cm"></td>
                    <td align="left" valign="middle">
                    <apex:outputText styleClass="size8" escape="false" value="This course is approved by Probitas Authentication and recognized as meeting the IAQG requirements for AS/EN/JISQ 9100:2016 Lead Auditor training."/></td>
                    <td width ="2cm" ></td>
                 </tr>
           </apex:panelgroup>
           <apex:panelGroup rendered="{!IF(AND(Enrollment__c.Exam_results__c = 'Pass exam & pass CA',Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'Probitas'),false,true)}">     
                 <tr>
                        <td width ="0.7cm" ></td> 
                        <td height="20" align="left"></td>
                 </tr>
                 <tr>
                    <td width ="0.7cm" ></td>
                    <td align="left" valign="middle"></td>
                    <td width ="2cm" ></td>
                 </tr>
           </apex:panelgroup> 
    </apex:panelgroup>  
       
</table>    
  
<br/><br/> <br/>   
<!--LOGOs LOGOs LOGOs LOGOs LOGOs LOGOs---->
  <table   width="99%" align="left" valign="middle" table-layout="fixed">
<tr>
    <td width ="0.8cm" ></td>
    <td>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Joint_Delivery__c = 'SEG',true,false)}" height="1.75cm" width="2.25cm" url="{!Enrollment__c.Training_Translations__r.SEG_logo__c}"/>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'ICEL',true,false)}"  url="{!Enrollment__c.Training_Translations__r.ICEL_Logo__c}"/>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'IEMA'&& Enrollment__c.Exam_results__c = 'IEMA - Pass exam',true,false)}"  url="{!Enrollment__c.Training_Translations__r.IEMA_Logo__c}" height="1.75cm" width="1.75cm" />
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Course_Format__c = 'Virtual Learning',true,false)}"  height="1.5cm"  style="padding-top:20px" url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000004D1AN&oid=00DD0000000mhEp"/>       
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Exam_results__c = 'JRCA - Pass',true,false)}" height="2cm" width="1.6cm" url="{!Enrollment__c.Training_Translations__r.JRCA_Logo__c}"/>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'JATA',true,false)}"  height="1.2cm" url="{!Enrollment__c.Training_Translations__r.JATA_Logo__c}"/>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Joint_Delivery__c = 'City of London Police',true,false)}"  height="1.3cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000003uZnn&oid=00DD0000000mhEp"/>
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Joint_Delivery__c = 'Cloud Security Alliance',true,false)}"  height="1.5cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000003uZno&oid=00DD0000000mhEp"/>       
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Joint_Delivery__c = 'IOSH',true,false)}"  height="1.5cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000003uZoM&oid=00DD0000000mhEp"/>  
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'Probitas'&&Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)}" height="1cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000004DEPQ&oid=00DD0000000mhEp"/>       
    <apex:image styleClass="logo" rendered="{!IF(Enrollment__c.Training_Event__r.Course__r.Certified_Course__c = 'SSIP'&&Enrollment__c.Exam_results__c = 'Pass exam & pass CA',true,false)}"  height="1.2cm"  url="https://bsi--c.documentforce.com/servlet/servlet.ImageServer?id=015D0000004DEPL&oid=00DD0000000mhEp"/>  
    
    
    </td>
    </tr>
</table>

<!-- this sets out the office address in the footer at the bottom of the page -->

  <table   width="99%" align="left" valign="middle" table-layout="fixed">
<tr>
     <td width ="0.8cm" ></td>  
     <td  valign="bottom">
         <apex:panelGroup styleClass="footer">
         {!Enrollment__c.Training_Translations__r.Royal_Charter__c}<br/><br/><br/>
         {!Enrollment__c.Training_Translations__r.Office_Address__c}
         </apex:panelGroup>  
     </td>     
</tr> 
</table>

</body> 

</apex:page>